---
- name: "Create organization {{ ldap_organization }}"
  ldap_entry:
    state: present
    dn: "{{ ldap_base }}"
    objectClass:
      - organization
      - dcObject
      - top
    attributes:
      o: "{{ ldap_organization }}"

- name: "Create organizational units for {{ ldap_organization }}"
  ldap_entry:
    state: present
    dn: "{{ item.dn }}"
    attributes:
      ou: "{{ item.ou }}"
    objectClass:
      - organizationalUnit
  with_items:
    - dn: "{{ ldap_user_group_dn }}"
      ou: "{{ ldap_user_group }}"

- name: create admin group
  ldap_entry:
    state: present
    dn: "{{ ldap_admin_group_dn }}"
    attributes:
      cn: "{{ ldap_admin_group }}"
      member: "{{ ldap_dn_bind }}"
      owner: "{{ ldap_dn_bind }}"
    objectClass:
      - groupOfNames
